<!DOCTYPE html>
<!-- Generated by Vantle::Web -->
<html lang="en" data-context="generation" data-page="web" data-root="../../../">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vantle.Web</title>
<link rel="icon" href="../../../resource/favicon.ico">
<script>try{let d=document.documentElement;let t=localStorage.getItem('theme');if(t)d.setAttribute('data-theme',t)}catch(e){}</script>
<link rel="stylesheet" href="../../../resource/system/document/vantle.css">
<script type="module">
import init from '../../../resource/system/document/compute.js';
await init();
</script>
</head>
<body>
<nav>
  <a class="nav-logo" href="../../../index.html">
    <img src="../../../resource/logo.png" alt="Vantle">
  </a>
  <div class="nav-links">
    <div class="nav-dropdown">
      <a href="../../../index.html">Vantle</a>
      <div class="nav-dropdown-menu">
        <a href="../../../info.html">Info</a>
        <a href="../../../notice.html">Notice</a>
        <a href="../../../module.html">Module</a>
        <a href="../../../license.html">License</a>
      </div>
    </div>
    <div class="nav-dropdown">
      <a href="../../../Molten/">Molten</a>
      <div class="nav-dropdown-menu">
        <a href="../../../Molten/system/spatialize/">Spatialize</a>
        <hr>
        <a href="../../../Molten/info.html">Info</a>
        <a href="../../../Molten/notice.html">Notice</a>
        <a href="../../../Molten/license.html">License</a>
      </div>
    </div>
    <div class="nav-dropdown">
      <a href="../../../system/generation/">Generation</a>
      <div class="nav-dropdown-menu">
        <a href="../../../system/generation/web/">Web</a>
        <a href="../../../system/generation/rust/">Autotest</a>
      </div>
    </div>
    <a href="../../../system/observation/">Observation</a>
    <a href="../../../system/spatialize/">Spatialize</a>
  </div>
</nav>
<div class="layout">
  <aside class="sidebar" aria-label="Page navigation">
    <div class="sidebar-label">Pages</div>
    <a href="../../../system/generation/">Generation</a>
    <a href="../../../system/generation/web/" aria-current="page">Web</a>
    <a href="../../../system/generation/rust/">Autotest</a>
    <div class="sidebar-label">Legal</div>
    <a href="../../../info.html">Info</a>
    <a href="../../../notice.html">Notice</a>
    <a href="../../../license.html">License</a>
  </aside>
  <main>
    <h1 id="web">Web</h1>
    <p class="subtitle">Web file generation by output format</p>
    <hr>
    <p>Generates web documentation from Rust DSL sources. Each generator targets a specific output format and integrates with Bazel through Starlark rules for authoring, publishing, and serving.</p>
    <hr>
    <section>
      <h2 id="html">HTML</h2>
      <p>Renders a <code>Page</code> element tree into complete HTML documents. Handles heading extraction for automatic table-of-contents generation, syntax-highlighted code blocks, and data injection for runtime assets.</p>
      <p>Pages are authored as <code>.document.rs</code> files using the <code>Composition</code> trait, which provides semantic methods for document structure:</p>
      <div class="code-block" data-language="rust"><span class="node-use"><span class="syntax-keyword">use</span> style<span class="syntax-punctuation">::</span><span class="syntax-entity">Composition</span><span class="syntax-punctuation">;</span>
</span>
<span class="node-function"><span class="syntax-keyword">fn</span> <span class="syntax-entity">main</span><span class="node-parameters"><span class="syntax-punctuation">(</span><span class="syntax-punctuation">)</span></span> <span class="syntax-operator">-&gt;</span> <span class="node-type">miette<span class="syntax-punctuation">::</span><span class="syntax-entity">Result</span><span class="syntax-punctuation">&lt;</span><span class="node-type"><span class="syntax-punctuation">(</span><span class="syntax-punctuation">)</span></span><span class="syntax-punctuation">&gt;</span></span><span class="node-block"> {
<span class="node-let">    <span class="syntax-keyword">let</span> <span class="node-pattern"><span class="syntax-variable">arguments</span></span> <span class="syntax-operator">=</span> <span class="node-expression"><span class="node-expression"><span class="node-path">html<span class="syntax-punctuation">::</span><span class="syntax-entity">Arguments</span><span class="syntax-punctuation">::</span>parse</span></span><span class="syntax-punctuation">(</span><span class="syntax-punctuation">)</span></span><span class="syntax-punctuation">;</span>
</span><span class="node-statement">    <span class="node-expression"><span class="node-expression"><span class="node-path">style<span class="syntax-punctuation">::</span>page</span></span><span class="syntax-punctuation">(</span><span class="node-expression"><span class="syntax-punctuation">&amp;</span><span class="node-expression"><span class="syntax-variable">arguments</span></span></span>, <span class="node-expression"><span class="syntax-string">&quot;Title&quot;</span></span>, <span class="node-expression"><span class="syntax-string">&quot;context&quot;</span></span>, <span class="node-expression"><span class="syntax-string">&quot;page&quot;</span></span>, <span class="node-expression"><span class="syntax-punctuation">|</span><span class="node-pattern"><span class="syntax-variable">c</span></span><span class="syntax-punctuation">|</span> {
<span class="node-statement">        <span class="node-expression"><span class="node-expression"><span class="node-expression"><span class="syntax-variable">c</span></span><span class="syntax-punctuation">.</span><span class="syntax-function">title</span><span class="syntax-punctuation">(</span><span class="node-expression"><span class="syntax-string">&quot;Title&quot;</span></span><span class="syntax-punctuation">)</span></span><span class="syntax-punctuation">.</span><span class="syntax-function">section</span><span class="syntax-punctuation">(</span><span class="node-expression"><span class="syntax-string">&quot;Overview&quot;</span></span>, <span class="node-expression"><span class="syntax-punctuation">|</span><span class="node-pattern"><span class="syntax-variable">s</span></span><span class="syntax-punctuation">|</span> {
<span class="node-statement">            <span class="node-expression"><span class="node-expression"><span class="syntax-variable">s</span></span><span class="syntax-punctuation">.</span><span class="syntax-function">paragraph</span><span class="syntax-punctuation">(</span><span class="node-expression"><span class="syntax-punctuation">|</span><span class="node-pattern"><span class="syntax-variable">p</span></span><span class="syntax-punctuation">|</span> <span class="node-expression"><span class="node-expression"><span class="syntax-variable">p</span></span><span class="syntax-punctuation">.</span><span class="syntax-function">text</span><span class="syntax-punctuation">(</span><span class="node-expression"><span class="syntax-string">&quot;Content here.&quot;</span></span><span class="syntax-punctuation">)</span></span></span><span class="syntax-punctuation">)</span></span>
</span>        }</span><span class="syntax-punctuation">)</span></span>
</span>    }</span><span class="syntax-punctuation">)</span></span>
</span>}
</span></span></div>
      <section>
        <h3 id="composition">Composition</h3>
        <p>The <code>Composition</code> trait adds high-level semantic methods to the body builder:</p>
        <ul>
          <li><code>title</code>, <code>subtitle</code>, <code>section</code>, <code>subsection</code> — document structure</li>
          <li><code>paragraph</code>, <code>aside</code>, <code>rule</code>, <code>term</code> — content blocks</li>
          <li><code>literal</code>, <code>highlight</code>, <code>shell</code> — code presentation</li>
          <li><code>link</code>, <code>bold</code>, <code>italic</code> — inline formatting</li>
        </ul>
      </section>
    </section>
    <hr>
    <section>
      <h2 id="style">Style</h2>
      <p>Generates CSS from a golden-ratio design system. All spacing, typography, and responsive breakpoints scale from <strong>PHI</strong> (1.618). Colors are defined as paired light/dark values, switchable via <code>data-theme</code> attribute.</p>
      <ul>
        <li><strong>Proportions</strong>: phi-scaled spacing variables from <code>--scale-n2</code> to <code>--scale-3</code></li>
        <li><strong>Typography</strong>: heading sizes follow the golden ratio scale</li>
        <li><strong>Layout</strong>: three-column grid (sidebar, main, outline) with responsive collapse</li>
        <li><strong>Themes</strong>: light and dark via CSS custom properties, persisted in localStorage</li>
      </ul>
    </section>
    <hr>
    <section>
      <h2 id="highlight">Highlight</h2>
      <p>Syntax highlighting dispatches to language-specific highlighters. Each produces HTML spans with semantic CSS classes for theme-aware coloring.</p>
      <table>
        <thead>
          <tr>
            <th>Language</th>
            <th>Strategy</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Rust</td>
            <td>AST via syn, with snippet fallback</td>
          </tr>
          <tr>
            <td>Molten</td>
            <td>Custom AST traversal</td>
          </tr>
          <tr>
            <td>JSON</td>
            <td>Structural value coloring</td>
          </tr>
          <tr>
            <td>Starlark</td>
            <td>Tree-sitter grammar</td>
          </tr>
          <tr>
            <td>Bash</td>
            <td>Tree-sitter grammar</td>
          </tr>
        </tbody>
      </table>
    </section>
    <hr>
    <section>
      <h2 id="assembly">Assembly</h2>
      <p>Compiles Rust to WebAssembly for client-side interactivity. The assembly chain produces <code>compute.js</code> and <code>compute_bg.wasm</code> via <code>rust_wasm_bindgen</code>.</p>
      <ul>
        <li><strong>Navigate</strong>: SPA navigation without page reloads</li>
        <li><strong>Theme</strong>: toggle button with localStorage persistence</li>
        <li><strong>Clipboard</strong>: copy-to-clipboard on code blocks</li>
        <li><strong>Outline</strong>: scroll-tracking table of contents</li>
        <li><strong>Scroll</strong>: smooth scroll behavior</li>
        <li><strong>Hamburger</strong>: mobile sidebar toggle</li>
      </ul>
    </section>
    <hr>
    <section>
      <h2 id="starlark">Starlark</h2>
      <p>Bazel rules for authoring, publishing, verifying, and serving documentation. All rules are loaded from <code>//component/web/starlark:defs.bzl</code>.</p>
      <section>
        <h3 id="document">document</h3>
        <p>Compiles a Rust DSL source into a binary, executes it, and collects the generated output. Standard dependencies (<code>component:web</code>, <code>html</code>, <code>miette</code>) are injected automatically.</p>
        <div class="code-block" data-language="starlark"><span class="syntax-function">document</span><span class="syntax-punctuation">(</span>
    <span class="syntax-variable">srcs</span> <span class="syntax-operator">=</span> <span class="syntax-punctuation">[</span><span class="syntax-string">&quot;</span><span class="syntax-string">page.document.rs</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">]</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">destination</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">path/index.html</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">deps</span> <span class="syntax-operator">=</span> <span class="syntax-punctuation">[</span><span class="syntax-string">&quot;</span><span class="syntax-string">//system/generation/web:style</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">]</span><span class="syntax-punctuation">,</span>
<span class="syntax-punctuation">)</span></div>
        <table>
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <code>srcs</code>
              </td>
              <td>Rust source files defining the page</td>
            </tr>
            <tr>
              <td>
                <code>destination</code>
              </td>
              <td>Workspace-relative output path</td>
            </tr>
            <tr>
              <td>
                <code>deps</code>
              </td>
              <td>Additional compile dependencies</td>
            </tr>
            <tr>
              <td>
                <code>data</code>
              </td>
              <td>Runtime data files for WASM or code injection</td>
            </tr>
            <tr>
              <td>
                <code>compile_data</code>
              </td>
              <td>
Compile-time data files for                 <code>include_str!</code>
 sources              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section>
        <h3 id="asset">asset</h3>
        <p>Wraps an existing file with a destination path for inclusion in publish manifests. Uses a zero-cost symlink action.</p>
        <div class="code-block" data-language="starlark"><span class="syntax-function">asset</span><span class="syntax-punctuation">(</span>
    <span class="syntax-variable">name</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">document.compute.js</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">src</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">:compute.js</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">destination</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">resource/system/document/compute.js</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
<span class="syntax-punctuation">)</span></div>
      </section>
      <section>
        <h3 id="publish">publish</h3>
        <p>Aggregates document and asset targets into a manifest, then copies all generated files into the workspace.</p>
        <div class="code-block" data-language="starlark"><span class="syntax-function">publish</span><span class="syntax-punctuation">(</span>
    <span class="syntax-variable">name</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">publish.documentation</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">srcs</span> <span class="syntax-operator">=</span> <span class="syntax-punctuation">[</span>
        <span class="syntax-string">&quot;</span><span class="syntax-string">:document.vantle</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
        <span class="syntax-string">&quot;</span><span class="syntax-string">//system/documentation:document.stylesheet</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
        <span class="syntax-string">&quot;</span><span class="syntax-string">//system/generation/web/assembly:document.compute.js</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-punctuation">]</span><span class="syntax-punctuation">,</span>
<span class="syntax-punctuation">)</span></div>
      </section>
      <section>
        <h3 id="verify">verify</h3>
        <p>Checks that generated files match what is checked into the repository. Fails with a drift report if any files differ.</p>
        <div class="code-block" data-language="starlark"><span class="syntax-function">verify</span><span class="syntax-punctuation">(</span>
    <span class="syntax-variable">name</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">verify.documentation</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
    <span class="syntax-variable">srcs</span> <span class="syntax-operator">=</span> <span class="syntax-punctuation">[</span><span class="syntax-string">&quot;</span><span class="syntax-string">:document.vantle</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">]</span><span class="syntax-punctuation">,</span>
<span class="syntax-punctuation">)</span></div>
      </section>
      <section>
        <h3 id="distribute">distribute</h3>
        <p>Serves the workspace directory over HTTP for local preview.</p>
        <div class="code-block" data-language="starlark"><span class="syntax-function">distribute</span><span class="syntax-punctuation">(</span>
    <span class="syntax-variable">name</span> <span class="syntax-operator">=</span> <span class="syntax-string">&quot;</span><span class="syntax-string">distribute.documentation</span><span class="syntax-string">&quot;</span><span class="syntax-punctuation">,</span>
<span class="syntax-punctuation">)</span></div>
      </section>
    </section>
    <footer>
      <p>© 2025 Vantle · <a href="https://vantle.org">@robert.vanderzee</a></p>
      <a class="footer-icon" href="https://github.com/Vantle/Vantle" aria-label="GitHub"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a>
    </footer>
  </main>
  <aside class="outline" aria-label="Table of contents">
    <a href="#web" data-depth="0">Web</a>
    <a href="#html" data-depth="1">HTML</a>
    <a href="#composition" data-depth="2">Composition</a>
    <a href="#style" data-depth="1">Style</a>
    <a href="#highlight" data-depth="1">Highlight</a>
    <a href="#assembly" data-depth="1">Assembly</a>
    <a href="#starlark" data-depth="1">Starlark</a>
    <a href="#document" data-depth="2">document</a>
    <a href="#asset" data-depth="2">asset</a>
    <a href="#publish" data-depth="2">publish</a>
    <a href="#verify" data-depth="2">verify</a>
    <a href="#distribute" data-depth="2">distribute</a>
  </aside>
</div>
</body>
</html>
